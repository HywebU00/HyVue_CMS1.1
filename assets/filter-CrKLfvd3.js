import{p as j,s as L,k as v,as as F,E as S,W as O,ab as A,b,n as _,F as x}from"./index-BNm_a0v5.js";const C=(t,r,e)=>{if(t==null||r==null)return-1;if(!r.length)return 0;t=t.toString().toLocaleLowerCase(),r=r.toString().toLocaleLowerCase();const l=[];let n=t.indexOf(r);for(;~n;)l.push([n,n+r.length]),n=t.indexOf(r,n+r.length);return l.length?l:-1};function w(t,r){if(!(t==null||typeof t=="boolean"||t===-1))return typeof t=="number"?[[t,t+r.length]]:Array.isArray(t[0])?t:[t]}const B=j({customFilter:Function,customKeyFilter:Object,filterKeys:[Array,String],filterMode:{type:String,default:"intersection"},noFilter:Boolean},"filter");function E(t,r,e){var m;const l=[],n=(e==null?void 0:e.default)??C,u=e!=null&&e.filterKeys?O(e.filterKeys):!1,a=Object.keys((e==null?void 0:e.customKeyFilter)??{}).length;if(!(t!=null&&t.length))return l;e:for(let f=0;f<t.length;f++){const[s,M=s]=O(t[f]),g={},i={};let c=-1;if((r||a>0)&&!(e!=null&&e.noFilter)){if(typeof s=="object"){if(s.type==="divider"||s.type==="subheader")continue;const k=u||Object.keys(M);for(const d of k){const I=A(M,d),K=(m=e==null?void 0:e.customKeyFilter)==null?void 0:m[d];if(c=K?K(I,r,s):n(I,r,s),c!==-1&&c!==!1)K?g[d]=w(c,r):i[d]=w(c,r);else if((e==null?void 0:e.filterMode)==="every")continue e}}else c=n(s,r,s),c!==-1&&c!==!1&&(i.title=w(c,r));const h=Object.keys(i).length,y=Object.keys(g).length;if(!h&&!y||(e==null?void 0:e.filterMode)==="union"&&y!==a&&!h||(e==null?void 0:e.filterMode)==="intersection"&&(y!==a||!h))continue}l.push({index:f,matches:{...i,...g}})}return l}function P(t,r,e,l){const n=L([]),u=L(new Map),a=v(()=>l!=null&&l.transform?F(r).map(f=>[f,l.transform(f)]):F(r));S(()=>{const f=typeof e=="function"?e():F(e),s=typeof f!="string"&&typeof f!="number"?"":String(f),M=E(a.value,s,{customKeyFilter:{...t.customKeyFilter,...F(l==null?void 0:l.customKeyFilter)},default:t.customFilter,filterKeys:t.filterKeys,filterMode:t.filterMode,noFilter:t.noFilter}),g=F(r),i=[],c=new Map;M.forEach(h=>{let{index:y,matches:k}=h;const d=g[y];i.push(d),c.set(d.value,k)}),n.value=i,u.value=c});function m(f){return u.value.get(f.value)}return{filteredItems:n,filteredMatches:u,getMatches:m}}function R(t,r,e){return e==null||!e.length?r:e.map((l,n)=>{const u=n===0?0:e[n-1][1],a=[b("span",{class:_(`${t}__unmask`)},[r.slice(u,l[0])]),b("span",{class:_(`${t}__mask`)},[r.slice(l[0],l[1])])];return n===e.length-1&&a.push(b("span",{class:_(`${t}__unmask`)},[r.slice(l[1])])),b(x,null,[a])})}export{R as h,B as m,P as u};
