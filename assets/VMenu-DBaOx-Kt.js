import{a as K,V as C,b as T}from"./VOverlay-By8TVnWW.js";import{f as q}from"./forwardRefs-C-GTDzx5.js";import{g as B,p as O,a as A,m as k,T as D,B as N,u as U,C as j,a8 as H,v as W,ae as X,s as Y,A as z,aN as J,J as G,av as M,y as Q,a7 as R,k as Z,au as _,aM as P,aO as ee,af as te,aP as ne}from"./index-D5MnFukX.js";import{u as ae}from"./scopeId-CP9cRHgS.js";import{a as x,g as oe,n as se,b as ie,d as re,s as I}from"./easing-Dh12F2RB.js";import{u as le,j as ue}from"./VImg-CFeJpGHd.js";const ce=O({target:[Object,Array]},"v-dialog-transition"),V=new WeakMap,fe=B()({name:"VDialogTransition",props:ce(),setup(t,v){let{slots:o}=v;const s={onBeforeEnter(n){n.style.pointerEvents="none",n.style.visibility="hidden"},async onEnter(n,g){var h;await new Promise(u=>requestAnimationFrame(u)),await new Promise(u=>requestAnimationFrame(u)),n.style.visibility="";const l=S(t.target,n),{x:c,y:i,sx:a,sy:m,speed:f}=l;V.set(n,l);const w=x(n,[{transform:`translate(${c}px, ${i}px) scale(${a}, ${m})`,opacity:0},{}],{duration:225*f,easing:re});(h=L(n))==null||h.forEach(u=>{x(u,[{opacity:0},{opacity:0,offset:.33},{}],{duration:225*2*f,easing:I})}),w.finished.then(()=>g())},onAfterEnter(n){n.style.removeProperty("pointer-events")},onBeforeLeave(n){n.style.pointerEvents="none"},async onLeave(n,g){var h;await new Promise(u=>requestAnimationFrame(u));let l;!V.has(n)||Array.isArray(t.target)||t.target.offsetParent||t.target.getClientRects().length?l=S(t.target,n):l=V.get(n);const{x:c,y:i,sx:a,sy:m,speed:f}=l;x(n,[{},{transform:`translate(${c}px, ${i}px) scale(${a}, ${m})`,opacity:0}],{duration:125*f,easing:ie}).finished.then(()=>g()),(h=L(n))==null||h.forEach(u=>{x(u,[{},{opacity:0,offset:.2},{opacity:0}],{duration:125*2*f,easing:I})})},onAfterLeave(n){n.style.removeProperty("pointer-events")}};return()=>t.target?A(D,k({name:"dialog-transition"},s,{css:!1}),o):A(D,{name:"dialog-transition"},o)}});function L(t){var o;const v=(o=t.querySelector(":scope > .v-card, :scope > .v-sheet, :scope > .v-list"))==null?void 0:o.children;return v&&[...v]}function S(t,v){const o=oe(t),s=se(v),[n,g]=getComputedStyle(v).transformOrigin.split(" ").map(r=>parseFloat(r)),[l,c]=getComputedStyle(v).getPropertyValue("--v-overlay-anchor-origin").split(" ");let i=o.left+o.width/2;l==="left"||c==="left"?i-=o.width/2:(l==="right"||c==="right")&&(i+=o.width/2);let a=o.top+o.height/2;l==="top"||c==="top"?a-=o.height/2:(l==="bottom"||c==="bottom")&&(a+=o.height/2);const m=o.width/s.width,f=o.height/s.height,w=Math.max(1,m,f),h=m/w||0,u=f/w||0,b=s.width*s.height/(window.innerWidth*window.innerHeight),e=b>.12?Math.min(1.5,(b-.12)*10+1):1;return{x:i-(n+s.left),y:a-(g+s.top),sx:h,sy:u,speed:e}}const de=O({id:String,submenu:Boolean,disableInitialFocus:Boolean,..._(K({closeDelay:250,closeOnContentClick:!0,locationStrategy:"connected",location:void 0,openDelay:300,scrim:!1,scrollStrategy:"reposition",transition:{component:fe}}),["absolute"])},"VMenu"),we=B()({name:"VMenu",props:de(),emits:{"update:modelValue":t=>!0},setup(t,v){let{slots:o}=v;const s=N(t,"modelValue"),{scopeId:n}=ae(),{isRtl:g}=U(),l=H(),c=j(()=>t.id||`v-menu-${l}`),i=W(),a=X(T,null),m=Y(new Set);te(T,{register(){m.value.add(l)},unregister(){m.value.delete(l)},closeParents(e){setTimeout(()=>{var r;!m.value.size&&!t.persistent&&(e==null||(r=i.value)!=null&&r.contentEl&&!ne(e,i.value.contentEl))&&(s.value=!1,a==null||a.closeParents())},40)}}),z(()=>{a==null||a.unregister(),document.removeEventListener("focusin",f)}),J(()=>s.value=!1);async function f(e){var y,p,E;const r=e.relatedTarget,d=e.target;await G(),s.value&&r!==d&&((y=i.value)!=null&&y.contentEl)&&((p=i.value)!=null&&p.globalTop)&&![document,i.value.contentEl].includes(d)&&!i.value.contentEl.contains(d)&&((E=M(i.value.contentEl)[0])==null||E.focus())}Q(s,e=>{e?(a==null||a.register(),R&&!t.disableInitialFocus&&document.addEventListener("focusin",f,{once:!0})):(a==null||a.unregister(),R&&document.removeEventListener("focusin",f))},{immediate:!0});function w(e){a==null||a.closeParents(e)}function h(e){var r,d,y,p,E;if(!t.disabled)if(e.key==="Tab"||e.key==="Enter"&&!t.closeOnContentClick){if(e.key==="Enter"&&(e.target instanceof HTMLTextAreaElement||e.target instanceof HTMLInputElement&&e.target.closest("form")))return;e.key==="Enter"&&e.preventDefault(),ee(M((r=i.value)==null?void 0:r.contentEl,!1),e.shiftKey?"prev":"next",F=>F.tabIndex>=0)||(s.value=!1,(y=(d=i.value)==null?void 0:d.activatorEl)==null||y.focus())}else t.submenu&&e.key===(g.value?"ArrowRight":"ArrowLeft")&&(s.value=!1,(E=(p=i.value)==null?void 0:p.activatorEl)==null||E.focus())}function u(e){var d;if(t.disabled)return;const r=(d=i.value)==null?void 0:d.contentEl;r&&s.value?e.key==="ArrowDown"?(e.preventDefault(),e.stopImmediatePropagation(),P(r,"next")):e.key==="ArrowUp"?(e.preventDefault(),e.stopImmediatePropagation(),P(r,"prev")):t.submenu&&(e.key===(g.value?"ArrowRight":"ArrowLeft")?s.value=!1:e.key===(g.value?"ArrowLeft":"ArrowRight")&&(e.preventDefault(),P(r,"first"))):(t.submenu?e.key===(g.value?"ArrowLeft":"ArrowRight"):["ArrowDown","ArrowUp"].includes(e.key))&&(s.value=!0,e.preventDefault(),setTimeout(()=>setTimeout(()=>u(e))))}const b=Z(()=>k({"aria-haspopup":"menu","aria-expanded":String(s.value),"aria-controls":c.value,onKeydown:u},t.activatorProps));return le(()=>{const e=C.filterProps(t);return A(C,k({ref:i,id:c.value,class:["v-menu",t.class],style:t.style},e,{modelValue:s.value,"onUpdate:modelValue":r=>s.value=r,absolute:!0,activatorProps:b.value,location:t.location??(t.submenu?"end":"bottom"),"onClick:outside":w,onKeydown:h},n),{activator:o.activator,default:function(){for(var r=arguments.length,d=new Array(r),y=0;y<r;y++)d[y]=arguments[y];return A(ue,{root:"VMenu"},{default:()=>{var p;return[(p=o.default)==null?void 0:p.call(o,...d)]}})}})}),q({id:c,Î¨openChildren:m},i)}});export{we as V,fe as a};
